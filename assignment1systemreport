#!/bin/bash

# Get system information
HOSTNAME=$(hostname)
OS=$(source /etc/os-release && echo "$NAME $VERSION")
UPTIME=$(uptime -p)

# Get hardware information
PROCESSOR=$(lscpu | grep "Model name" | awk -F ':' '{print $2}' | xargs)
CPU_SPEED=$(lscpu | grep "CPU max MHz" | awk -F ':' '{print $2}' | xargs)
INSTALLED_RAM=$(free -h | awk '/^Mem:/ {print $2}')
DISKS=$(lsblk -o NAME,SIZE,MODEL | grep -v "NAME" | awk '{print $3 " (" $2 ")"}')
VIDEO_CARD=$(lspci | grep -i "VGA" | cut -d ':' -f 3 | xargs)

# Get network information
FQDN=$(hostname -f)
HOST_IP=$(hostname -I | cut -d ' ' -f 1)
GATEWAY_IP=$(ip r | awk '/default/ {print $3}')
DNS_SERVER=$(cat /etc/resolv.conf | awk '/nameserver/ {print $2}' | xargs)

INTERFACE_NAME=$(ip a | grep "^[0-9]" | awk '{print $2}' | cut -d ':' -f 1)
IP_ADDRESS=$(ip a | grep "inet " | grep -v "127.0.0.1" | awk '{print $2}')

# Get system status
USERS_LOGGED_IN=$(who | cut -d ' ' -f 1 | xargs)
DISK_SPACE=$(df -h --output=source,avail | grep -v "Filesystem" | awk '{print $1 " " $2}')
PROCESS_COUNT=$(ps -e | wc -l)
LOAD_AVERAGES=$(cat /proc/loadavg | awk '{print $1 ", " $2 ", " $3}')
MEMORY_ALLOCATION=$(free -h | awk '/Mem:/ {print $3 " used out of " $2}')
LISTENING_PORTS=$(ss -tuln | awk 'NR > 1 {print $4}' | xargs)
UFW_RULES=$(sudo ufw status numbered | awk '/\[ [0-9]+ / {print $3}')

# Generate the system report
echo ""
echo "System Report generated by $USER, $(date)"
echo ""
echo "System Information"
echo "------------------"
echo "Hostname: $HOSTNAME"
echo "OS: $OS"
echo "Uptime: $UPTIME"
echo ""
echo "Hardware Information"
echo "--------------------"
echo "CPU: $PROCESSOR"
echo "Speed: $CPU_SPEED MHz"
echo "RAM: $INSTALLED_RAM"
echo "Disks: $DISKS"
echo "Video: $VIDEO_CARD"
echo ""
echo "Network Information"
echo "-------------------"
echo "FQDN: $FQDN"
echo "Host Address: $HOST_IP"
echo "Gateway IP: $GATEWAY_IP"
echo "DNS Server: $DNS_SERVER"
echo ""
echo "InterfaceName: $INTERFACE_NAME"
echo "IP Address: $IP_ADDRESS"
echo ""
echo "System Status"
echo "-------------"
echo "Users Logged In: $USERS_LOGGED_IN"
echo "Disk Space: $DISK_SPACE"
echo "Process Count: $PROCESS_COUNT"
echo "Load Averages: $LOAD_AVERAGES"
echo "Memory Allocation: $MEMORY_ALLOCATION"
echo "Listening Network Ports: $LISTENING_PORTS"
echo "UFW Rules: $UFW_RULES"
echo ""
